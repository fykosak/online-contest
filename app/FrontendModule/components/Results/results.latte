{*{cache "results"}*}
{cache}
{var $teams => $teams->fetchAssoc("category,id_team")}
{var $bonus => $bonus->fetchAssoc("id_team")}
{var $penality => $penality->fetchAssoc("id_team")}

{foreach $categories AS $category => $name}
	<h2 id="{$category}">{$name}</h2>
	<table class="table table-condensed table-striped small">
		<thead>
			<th>#</th>
			<th>{_'tým'}</th>
			<th>{_'celkem bodů'}</th>
			<th>{_'bonusové body'}</th>
			<th>{_'záporné body'}</th>
		</thead>
		{if isset($teams[$category])}
			{foreach $teams[$category] AS $team}
			<tr class="{if $team->activity == 0}text-muted{/if}">
				<td>{$iterator->getCounter()}</td>
				<td>{$team->name}</td>
				<td>
					{if !empty($team->score)}
						{$team->score}
					{else}
						0
					{/if}
				</td>
				<td>
					{if isset($bonus[$team->id_team])}
						{$bonus[$team->id_team]->score}
					{else}
						0
					{/if}
				</td>
				<td>
					{if isset($penality[$team->id_team])}
						{$penality[$team->id_team]->score}
					{else}
						0
					{/if}
				</td>
			</tr>
			{/foreach}
		{/if}
	</table>
{/foreach}
{/cache}